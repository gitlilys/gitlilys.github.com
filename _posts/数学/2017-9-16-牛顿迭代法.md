---
layout:     post
title: "牛顿迭代法求方程的根"
date: 2017-09-16
author: "罗渊"
header-img: "img/post-bg-ios9-web.jpg"
catalog: true
tag: 数学
---

### 原理剖析

> 使用 **二分法**

如何用计算机求出$$\sqrt{2}$$值呢? 当然，首先想到的是二分法，设x刚开始的区间为(0,2)，设根的值为t，那么第一次$$t=1$$，显然1的平方小于2，所以缩小区间为(1,2)，第二次去$$t=1.5$$，因为1.5的平方大于2，所以下一个区间为(1,1.5)，这样不断地分下去，可以得到根的近似值。但是这种方法的效率没有 **牛顿迭代法**的效率高。

> 使用 **牛顿迭代法**
>

我们要求$$\sqrt{c}$$的值，c是常数，我们可以构造一个函数 $$y=x^2-c$$，求$$\sqrt{c}$$的值就是得到函数的根。首先我们先画出这个函数的图像。
[![Snipaste_2017-09-16_15-14-56b5fdc.md.png](https://moetu.fastmirror.org/images/2017/09/16/Snipaste_2017-09-16_15-14-56b5fdc.md.png)](https://moetu.org/image/eK6N)

我们在x轴上去一点t,过t点做垂线交函数图像于点y1，y1的值为$$t^2-c$$，过点(t,y1)做函数的切线，交x轴于t1点。我们可以想一下，如果这一段函数图像是直线的话，那么交点就是我们要求的根，但是很遗憾，它是一条曲线，所以我们得到的根有误差，已交点过x轴再做垂线，交函数于点y2，那么以(t1,y2)这个点再做函数的切线，不断这样做下去，交点就会不断地逼近于函数的根，我们也就得到了$$\sqrt{c}$$的近似值。

[![Snipaste_2017-09-16_17-02-48a45d9.md.png](https://moetu.fastmirror.org/images/2017/09/16/Snipaste_2017-09-16_17-02-48a45d9.md.png)](https://moetu.org/image/eRcY)

**下面说一下推导过程:**

我们先假设切线方程为 $$y = kx + b$$
切线的斜率求导得 $$\dot y = 2x$$，又因为函数过点$$(t, t^2-c)$$，所以切线交x轴的值为 $$(t + c/t)/2$$，之后我们令得到的值为新的t，这样就可以不断地迭代，得出根的近似值。
还有一点，它的精确度如何控制？
也很简单，设两次切线交x轴的点的差值为w，它们之间的关系为$$w*k=t^2-c$$，那么w的值为$$(t^2-c)/2t$$，即可以用$$t-c/t$$来控制精度。


### 算法实现

```java
public static double sqrt(double c) {
        if(c < 0)
            return Double.NaN;
        double err = 1e-15;
        double t = c;
        while(Math.abs(t-c/t) > err*t)
            t = (c/t+t) / 2.0;
        return t;
    }
```

### 参考书籍

* **《算法》**
